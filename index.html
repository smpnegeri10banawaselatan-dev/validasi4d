<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Validasi Data Publik dari Google Sheets</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    select, button { font-size: 16px; padding: 8px; margin: 5px 0; }
    .table-container { overflow-x: auto; margin-top: 20px; }
    table { border-collapse: collapse; width: 100%; min-width: 600px; }
    th, td { padding: 8px; border: 1px solid #ccc; text-align: center; }
  </style>
</head>
<body>
  <h2>Raw Data dari Google Sheets (Publik)</h2>
  <label>Pilih AS (kolom B):</label>
  <select id="asSelect">
    <option value="">Semua</option>
  </select>
  <button onclick="loadData()">Muat Data</button>

  <div class="table-container">
    <table id="tableData">
      <thead><tr><th>AS</th><th>4D</th><th>3D</th><th>2D</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const SPREADSHEET_ID = '18nXx5IcD80NT1xSkhNM4hcVmoxgzuhD0oioagDfBxBs';
    const csvUrl = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/export?format=csv&gid=0`;
    
    async function loadData() {
      const res = await fetch(csvUrl);
      const text = await res.text();
      const lines = text.trim().split('\n').map(line => line.split(','));
      const rows = lines.slice(1, 11); // baris 2â€“11
      const data = rows.map(cols => ({
        AS: cols[1], prediksi4D: cols[2], prediksi3D: cols[3], prediksi2D: cols[4]
      }));
      
      populateSelect(data);
      renderTable(data);
    }

    function populateSelect(data) {
      const select = document.getElementById('asSelect');
      const uniqueAS = [...new Set(data.map(r => r.AS))];
      uniqueAS.forEach(as => {
        const opt = document.createElement('option');
        opt.value = as;
        opt.textContent = `AS ${as}`;
        select.appendChild(opt);
      });
    }

    function renderTable(data) {
      const tbody = document.getElementById('tableData').querySelector('tbody');
      let filtered = data;
      const sel = document.getElementById('asSelect').value;
      if (sel) filtered = data.filter(r => r.AS === sel);

      tbody.innerHTML = filtered.map(r =>
        `<tr><td>${r.AS}</td><td>${r.prediksi4D}</td><td>${r.prediksi3D}</td><td>${r.prediksi2D}</td></tr>`
      ).join('') || `<tr><td colspan="4">Tidak ada data</td></tr>`;
    }
  </script>
</body>
</html>
